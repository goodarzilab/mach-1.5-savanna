{

  'train_micro_batch_size_per_gpu': 1,
  'gradient_accumulation_steps': 1,

  'checkpoint-activations': false,
  'checkpoint-num-layers': 1,
  'use_fp8_linears': true,
  
  'num_layers': 4,
  'hidden_size': 768,
  'num_attention_heads': 12,
  'num_groups_hyena': 768,
  'num_groups_hyena_medium': 48,
  'num_groups_hyena_short': 48,
  'num_groups_hyena_mlp': 48,
  'use_depthwise_short_conv_grouping': true,
  'operator-config':
    [  [["flash_v2"], 4], ],
  'seq_length': 8192,

  'pipe_parallel_size': 1,
  'model_parallel_size': 1,
  'make_vocab_size_divisible_by': 8,

  'max_position_embeddings': 8192,
  'hyena_mr_len': 128,
  'log_hyena_norms': false,
  'log_attn_norms': false,
  'pos_emb': 'rotary',
  'rotary_emb_base': 1000000,
  'rotary_pct': 1,
  'prenorm': true,
  'postnorm': false,
  'pre_mlp_norm': true,
  'outer_mlp_norm': false,
  'no_weight_tying': false,
  'gpt_j_residual': false,
  'normalize_hyena_filters': false,
  'short-conv-L': 3,
  'hyena_filter_fast_decay': 0.3,
  'hyena_filter_slow_decay': 1.2,
  'hyena_filter_w': 14,
  'hyena_filter_cls': 'implicit_complex_modal',
  'modal_residue_factors': 5,
  'modal_pole_factors': 1,
  'hyena_filter_order': 16,
  'hyena_filter_wd': 0.,
  'use_fast_heads': false,
  'use_slow_heads': false,
  'use-hyena-filter': true,
  'output_layer_parallelism': 'column',
  'bias_dropout_fusion': false,
  'norm': 'rmsnorm',
  'rms_norm_epsilon': 1.0e-6,
  'identity_mlp': false,
  'mlp_type': 'short_hyena',
  'scaled-upper-triang-masked-softmax-fusion': true,
  'bias-gelu-fusion': false,
  'init_method': 'small_init',
  'output_layer_init_method': 'wang_init',
  'optimizer':
    {
      'type': 'Adam',
      'params': { 'lr': 0.000818, 'betas': [0.9, 0.95], 'eps': 1.0e-8 },
    },
  'min_lr': 0.0000818,
  'data-impl': 'mmap',
  'partition-activations': false,
  'synchronize-each-layer': false,
  'gradient_clipping': 1.0,
  'weight-decay': 0.1,
  'hidden-dropout': 0.0,
  'attention-dropout': 0.0,
  'precision': 'bfloat16',
  'bf16': { 'enabled': true },
  'train-iters': 10,
  'lr-decay-iters': 10000,
  'distributed-backend': 'nccl',
  'lr-decay-style': 'cosine',
  'warmup': 0.01,
  'checkpoint-factor': 10000,
  #  "extra_save_iters": [4],
  'eval-interval': 10000,
  'eval-iters': 1,
  'log-interval': 1,
  'steps_per_print': 1,
  'keep-last-n-checkpoints': 1,
  'wall_clock_breakdown': false,
  'tokenizer_type': CharLevelTokenizer,

  'include': 'localhost@localhost:0',
  'num_gpus': 1,
  'make_gated_mlp_multiple_of': 64,
  'materialize_attn_mask': false, # default false, to save memory
  'fast_conv_proj': false,
  'hyena_se_len': 7,
  'use_wandb': true,
  'to_upper': 'weighted',
  'lowercase_loss_reweighting': 0.1,
  'hyena_mlp_len': 7,
}